 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/index.html b/index.html
index 94e938f2f528d216b62412980be0aa0459b29154..b432bd8c2d802ed1822dc9ecf8cf3381cf88ef4b 100644
--- a/index.html
+++ b/index.html
@@ -1,32 +1,32 @@
 
 <!DOCTYPE html>
 <html lang="pt-BR">
 <head>
   <meta charset="UTF-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
-  <title>Almoxarifado Pro - Controle de Estoque</title>
+  <title>ALMOX2026 - Controle de Estoque</title>
   <style>
     /* ===== RESET ===== */
     * { margin: 0; padding: 0; box-sizing: border-box; }
     :root{
       --primary:#00d4ff; --primary-dark:#00a8cc; --secondary:#7c3aed;
       --success:#10b981; --danger:#ef4444; --warning:#f59e0b;
       --bg-dark:#0f0f1e; --bg-darker:#0a0a14; --bg-card:#1a1a2e; --bg-hover:#252541;
       --text-primary:#e0e0ff; --text-secondary:#a0a0c0; --border:#3a3a5c;
     }
     html, body { height: 100%; width: 100%; }
     body{
       font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
       background: linear-gradient(135deg,var(--bg-dark) 0%,var(--bg-darker) 100%);
       color: var(--text-primary); line-height: 1.6; font-size: 16px;
     }
     .app{ display:grid; grid-template-columns:260px 1fr; height:100vh; }
 
     /* ===== SIDEBAR ===== */
     .sidebar{
       background:var(--bg-card); border-right:1px solid var(--border);
       overflow-y:auto; display:flex; flex-direction:column;
       position:fixed; width:260px; height:100vh; left:0; top:0; z-index:200;
     }
     .sidebar-header{
       background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%);
@@ -220,123 +220,124 @@
         flex-direction:row;
       }
       .sidebar-nav{ display:flex; overflow-x:auto; flex:1; }
       .nav-item{ border-left:none; border-bottom:3px solid transparent; white-space:nowrap; }
       .container{ margin-left:0; }
       .header{ flex-direction:column; align-items:flex-start; }
       .form-row{ grid-template-columns:1fr; }
     }
     @media (max-width:480px){
       .header{ padding:12px; gap:12px; }
       .header-title{ font-size:1.2em; margin-bottom:6px; }
       .header-stats{ gap:4px; font-size:.7em; }
       .stat-item{ padding:4px 8px; }
       .stat-value{ font-size:1.1em; }
       .stat-box-wrapper{ grid-template-columns:1fr; }
     }
     ::-webkit-scrollbar{ width:6px; }
     ::-webkit-scrollbar-track{ background:var(--bg-hover); }
     ::-webkit-scrollbar-thumb{ background:var(--primary); border-radius:3px; }
   </style>
 </head>
 <body>
   <div class="app">
     <!-- SIDEBAR -->
     <div class="sidebar">
-      <div class="sidebar-header">ğŸ“¦ ALMOXARIFADO</div>
+      <div class="sidebar-header">ğŸ“¦ ALMOX2026</div>
       <div class="sidebar-nav">
         <div class="nav-item active" onclick="mudarSecao('estoque', this)">ğŸ“¦ Estoque</div>
         <div class="nav-item" onclick="mudarSecao('relatorio', this)">ğŸ“Š RelatÃ³rios</div>
         <div class="nav-item" onclick="abrirModalDados()">ğŸ’¾ Dados</div>
         <div class="nav-item" onclick="mudarSecao('config', this)">âš™ï¸ Config</div>
       </div>
       <div class="sidebar-actions">
         <button class="action-btn" onclick="abrirModalDados()">ğŸ’¾ Dados</button>
         <button class="action-btn" onclick="mudarSecao('relatorio', document.querySelector('.sidebar-nav .nav-item:nth-child(2)'))">ğŸ“Š RelatÃ³rios</button>
       </div>
     </div>
 
     <!-- CONTAINER -->
     <div class="container">
       <!-- HEADER -->
       <div class="header">
         <div class="header-left">
-          <div class="header-title" id="titulo">ğŸ“¦ ESTOQUE</div>
+          <div class="header-title" id="titulo">ğŸ“¦ ALMOX2026</div>
           <div class="header-stats">
             <div class="stat-item"><span>Total:</span><span class="stat-value" id="statTotal">0</span></div>
             <div class="stat-item" style="background: rgba(16, 185, 129, 0.2);">
               <span>âœ… OK:</span><span class="stat-value" id="statOk" style="color: var(--success);">0</span>
             </div>
             <div class="stat-item" style="background: rgba(245, 158, 11, 0.2);">
               <span>âš ï¸ Baixo:</span><span class="stat-value" id="statBaixo" style="color: var(--warning);">0</span>
             </div>
             <div class="stat-item" style="background: rgba(239, 68, 68, 0.2);">
               <span>âŒ Vazio:</span><span class="stat-value" id="statVazio" style="color: var(--danger);">0</span>
             </div>
           </div>
         </div>
         <div class="header-actions">
-          <button class="btn-header" onclick="abrirModalDados()">ğŸ’¾ Dados</button>
+          <button class="btn-header" onclick="salvarArquivoJSON(true)">ğŸ’¾ Salvar Dados</button>
+          <button class="btn-header" onclick="abrirModalDados()">ğŸ“ Dados</button>
           <button class="btn-header" onclick="mudarSecao('relatorio', document.querySelector('.sidebar-nav .nav-item:nth-child(2)'))">ğŸ“Š RelatÃ³rios</button>
         </div>
       </div>
 
       <!-- SEÃ‡ÃƒO ESTOQUE -->
       <div id="secEstoque" class="section" style="display:flex; flex-direction:column; flex:1;">
         <div class="filtros">
           <div class="filtro-group">
             <label class="filtro-label">ğŸ” Buscar</label>
             <input type="search" id="busca" placeholder="Nome, cÃ³digo..." onkeyup="filtrar()" />
           </div>
           <div class="filtro-group">
             <label class="filtro-label">ğŸ“‚ Setor</label>
             <select id="setor" onchange="filtrar()">
               <option value="">Todos</option>
             </select>
           </div>
           <div class="filtro-group">
             <label class="filtro-label">âš ï¸ Status</label>
             <select id="status" onchange="filtrar()">
               <option value="">Todos</option>
               <option value="ok">âœ… OK</option>
               <option value="baixo">âš ï¸ Baixo</option>
               <option value="vazio">âŒ Vazio</option>
             </select>
           </div>
           <button class="btn-filtro" onclick="limparFiltros()" style="width:100%;">ğŸ”„ Limpar</button>
         </div>
         <div class="content">
           <div class="produtos-grid" id="gridProdutos">
             <div style="text-align:center; color: var(--text-secondary); padding:20px;">Carregando...</div>
           </div>
         </div>
       </div>
 
       <!-- SEÃ‡ÃƒO RELATÃ“RIOS -->
       <div id="secRelatorio" class="section" style="display:none; flex:1; overflow-y:auto;">
         <div class="content">
-          <h2 style="color: var(--primary); margin-bottom: 20px; font-size: 1.6em;">ğŸ“Š RELATÃ“RIOS</h2>
+          <h2 style="color: var(--primary); margin-bottom: 20px; font-size: 1.6em;">ğŸ“Š RELATÃ“RIOS ALMOX2026</h2>
 
           <h3 style="color: var(--text-primary); margin-bottom: 12px;">ğŸ“ˆ Resumo Geral</h3>
           <div class="stat-box-wrapper">
             <div class="stat-box" onclick="abrirModalRelatorio('todos')">
               <div class="stat-box-label">ğŸ“¦ Total</div>
               <div class="stat-box-value" id="relTotalBox">0</div>
             </div>
             <div class="stat-box success" onclick="abrirModalRelatorio('ok')">
               <div class="stat-box-label">âœ… OK</div>
               <div class="stat-box-value" id="relOkBox">0</div>
             </div>
             <div class="stat-box warning" onclick="abrirModalRelatorio('baixo')">
               <div class="stat-box-label">âš ï¸ Baixo</div>
               <div class="stat-box-value" id="relBaixoBox">0</div>
             </div>
             <div class="stat-box danger" onclick="abrirModalRelatorio('vazio')">
               <div class="stat-box-label">âŒ Vazio</div>
               <div class="stat-box-value" id="relVazioBox">0</div>
             </div>
           </div>
 
           <h3 style="color: var(--text-primary); margin-top: 24px; margin-bottom: 12px;">ğŸ“‚ Por Setor</h3>
           <table class="rel-table" onclick="abrirModalSetores()">
             <thead>
               <tr><th>Setor</th><th style="text-align:center;">Total</th><th style="text-align:center;">OK</th></tr>
@@ -404,75 +405,77 @@
         <button class="btn btn-secondary" onclick="fecharModal('modalEditar')">Cancelar</button>
         <button class="btn btn-danger" onclick="deletarProduto()">ğŸ—‘ï¸ Deletar</button>
         <button class="btn btn-primary" onclick="salvarEdicao()">âœ… Salvar</button>
       </div>
     </div>
   </div>
 
   <!-- ===== MODAL RELATÃ“RIO ===== -->
   <div class="modal-overlay" id="modalRelatorio">
     <div class="modal-box">
       <div class="modal-header">
         <span id="relTituloModal">ğŸ“Š RELATÃ“RIO</span>
         <button class="modal-close" onclick="fecharModal('modalRelatorio')">&times;</button>
       </div>
       <div class="modal-body" id="relConteudoModal">Carregando...</div>
       <div class="modal-footer">
         <button class="btn btn-secondary" onclick="fecharModal('modalRelatorio')">Fechar</button>
         <button class="btn btn-primary" onclick="imprimirRelatorio()">ğŸ–¨ï¸ Imprimir</button>
       </div>
     </div>
   </div>
 
   <!-- ===== MODAL DADOS ===== -->
   <div class="modal-overlay" id="modalDados">
     <div class="modal-box">
-      <div class="modal-header">ğŸ’¾ DADOS
+      <div class="modal-header">ğŸ’¾ DADOS ALMOX2026
         <button class="modal-close" onclick="fecharModal('modalDados')">&times;</button>
       </div>
       <div class="modal-body">
         <p style="color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9em;">Gerencie seus dados:</p>
         <div style="display:grid; grid-template-columns: 1fr; gap: 8px; margin-bottom: 16px;">
           <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">ğŸ“¥ Importar JSON</button>
+          <button class="btn btn-primary" onclick="salvarArquivoJSON(true)">ğŸ’¾ Salvar Dados</button>
           <button class="btn btn-primary" onclick="exportarJSON()">ğŸ“¤ Exportar JSON</button>
           <button class="btn btn-primary" onclick="exportarCSV()" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">ğŸ“Š Exportar CSV</button>
         </div>
         <input type="file" id="fileInput" accept=".json" style="display:none;" onchange="importarJSON(event)">
         <div style="margin-top:10px; color: var(--text-secondary); font-size:.85em;">
           <strong>Dica:</strong> se vocÃª quiser carregar automaticamente um <code>produtos.json</code>, coloque este HTML e o arquivo na mesma pasta e abra via servidor (ex.: Live Server).
         </div>
       </div>
     </div>
   </div>
 
   <!-- TOAST -->
   <div id="toast" class="toast"></div>
 
   <script>
     let produtos = [];
     let filtrados = [];
     let produtoEditando = null;
+    let arquivoHandle = null;
 
     const SETORES_UNICOS = ["CONSUMO","LIMPEZA","ALIMENTOS","CONSTRUÃ‡ÃƒO","HIDRÃULICA","ELÃ‰TRICA","PAPELARIA","ESCRITÃ“RIO"];
 
     const dadosIniciais = [
       { codigo1:"28912", codigo2:"28192", nome:"GUARDANAPO DE PAPEL PEQUENO FOLHA DUPLAS 50 UNIDADES", estoqueMin:30, estoqueAtual:40, preco:0, setor:"CONSUMO" },
       { codigo1:"prod_986409", codigo2:"986409", nome:"Ã“LEO DE SOJA 900ML", estoqueMin:100, estoqueAtual:11, preco:0, setor:"ALIMENTOS" },
       { codigo1:"prod_110009", codigo2:"110009", nome:"ÃGUA PERFUMADA ODORIZANTE LONGA DURAÃ‡ÃƒO 340ML", estoqueMin:50, estoqueAtual:98, preco:0, setor:"LIMPEZA" },
       { codigo1:"17635735718525700", codigo2:"110001", nome:"ÃGUA SANITÃRIA 1LT", estoqueMin:50, estoqueAtual:200, preco:0, setor:"LIMPEZA" },
       { codigo1:"prod_110002", codigo2:"110002", nome:"ÃGUA SANITÃRIA FRASCO 2L", estoqueMin:300, estoqueAtual:1206, preco:0, setor:"LIMPEZA" },
       { codigo1:"prod_110004", codigo2:"110004", nome:"ÃLCOOL ETÃLICO 46Âº INPM ABRE E FECHA 1 LT", estoqueMin:20, estoqueAtual:70, preco:0, setor:"LIMPEZA" },
       { codigo1:"prod_110003", codigo2:"110003", nome:"ÃLCOOL ETÃLICO HIDRATADO GEL 70 INPM 460G", estoqueMin:100, estoqueAtual:210, preco:0, setor:"LIMPEZA" },
       { codigo1:"prod_110500", codigo2:"110500", nome:"ÃLCOOL LÃQUIDO 70", estoqueMin:100, estoqueAtual:0, preco:0, setor:"LIMPEZA" },
       { codigo1:"prod_130002", codigo2:"130002", nome:"AÃ‡ÃšCAR CRISTAL BRANCO TIPO I PACOTE 5KG", estoqueMin:100, estoqueAtual:213, preco:0, setor:"ALIMENTOS" },
       { codigo1:"NULL", codigo2:"123", nome:"ABRAÃ‡ADEIRA AÃ‡O TIPO U COMUM 1/2\\\"", estoqueMin:0, estoqueAtual:0, preco:0.35, setor:"CONSTRUÃ‡ÃƒO" }
     ];
 
     document.addEventListener('DOMContentLoaded', () => {
       carregarDados();
       construirSetores();
       filtrar();
       atualizarStats();
       carregarRelatorios();
       exibirToast('âœ… Sistema carregado!');
     });
 
@@ -515,50 +518,51 @@
               }));
               salvarDados(false);
               filtrados = [...produtos];
               exibirToast('âœ… Produtos carregados do arquivo!');
               return;
             }
           }
         }
       }catch(err){
         // ignora e cai no fallback
       }
 
       // 3) fallback
       produtos = dadosIniciais.map(p => ({...p}));
       salvarDados(false);
       filtrados = [...produtos];
     }
 
     function salvarDados(recarregar = true){
       localStorage.setItem('produtosAlmox', JSON.stringify(produtos));
       if (recarregar){
         filtrar();
         atualizarStats();
         carregarRelatorios();
       }
+      salvarArquivoJSON();
     }
 
     function construirSetores(){
       const select = document.getElementById('setor');
       select.innerHTML = '<option value="">Todos</option>';
       SETORES_UNICOS.forEach(s => {
         const opt = document.createElement('option');
         opt.value = s; opt.textContent = s; select.appendChild(opt);
       });
     }
 
     function filtrar(){
       const busca = document.getElementById('busca').value.toLowerCase();
       const setor = document.getElementById('setor').value;
       const status = document.getElementById('status').value;
 
       filtrados = produtos.filter(p => {
         const match = !busca ||
           (p.nome && p.nome.toLowerCase().includes(busca)) ||
           (p.codigo1 && String(p.codigo1).toLowerCase().includes(busca)) ||
           (p.codigo2 && String(p.codigo2).toLowerCase().includes(busca));
 
         const setorMatch = !setor || p.setor === setor;
 
         let statusMatch = !status;
@@ -844,51 +848,51 @@
           <thead>
             <tr style="background: linear-gradient(135deg, var(--danger) 0%, #c91e3a 100%); color: white;">
               <th>CÃ³digo</th><th>Produto</th><th style="text-align:center;">Atual</th><th style="text-align:center;">MÃ­n</th><th>Setor</th>
             </tr>
           </thead>
           <tbody>${tabela}</tbody>
         </table>` :
         '<p style="color: var(--success); text-align:center; padding:20px;">âœ… Nenhum produto crÃ­tico!</p>';
 
       document.getElementById('relTituloModal').textContent = 'ğŸš¨ PRODUTOS CRÃTICOS';
       document.getElementById('relConteudoModal').innerHTML = conteudo;
       abrirModal('modalRelatorio');
     }
 
     function imprimirRelatorio(){
       window.print();
       exibirToast('ğŸ–¨ï¸ Enviado para impressora!');
     }
 
     function mudarSecao(sec, el){
       document.querySelectorAll('.section').forEach(e => e.style.display = 'none');
       document.querySelectorAll('.nav-item').forEach(e => e.classList.remove('active'));
 
       if (sec === 'estoque'){
         document.getElementById('secEstoque').style.display = 'flex';
-        document.getElementById('titulo').textContent = 'ğŸ“¦ ESTOQUE';
+        document.getElementById('titulo').textContent = 'ğŸ“¦ ALMOX2026';
       } else if (sec === 'relatorio'){
         document.getElementById('secRelatorio').style.display = 'flex';
         document.getElementById('titulo').textContent = 'ğŸ“Š RELATÃ“RIOS';
         carregarRelatorios();
       } else if (sec === 'config'){
         document.getElementById('secConfig').style.display = 'flex';
         document.getElementById('titulo').textContent = 'âš™ï¸ CONFIG';
       }
 
       if (el && el.classList) el.classList.add('active');
     }
 
     function abrirModal(id){ document.getElementById(id).classList.add('active'); }
     function fecharModal(id){ document.getElementById(id).classList.remove('active'); }
     function abrirModalDados(){ abrirModal('modalDados'); }
 
     window.addEventListener('click', (e) => {
       if (e.target.classList && e.target.classList.contains('modal-overlay')){
         e.target.classList.remove('active');
       }
     });
 
     function importarJSON(e){
       const file = e.target.files && e.target.files[0];
       if(!file) return;
@@ -925,56 +929,82 @@
 
             const substituir = confirm('â“ SUBSTITUIR dados atuais?\nOK = Sim\nCancel = Mesclar');
             if (substituir) produtos = mapeados;
             else produtos = [...produtos, ...mapeados];
 
             salvarDados(true);
             exibirToast(`âœ… ${mapeados.length} importados!`);
             fecharModal('modalDados');
             e.target.value = '';
           } else {
             exibirToast('âš ï¸ JSON vazio ou invÃ¡lido', 'aviso');
           }
         }catch(err){
           exibirToast('âŒ Erro ao ler JSON', 'erro');
         }
       };
       reader.readAsText(file);
     }
 
     function exportarJSON(){
       const json = JSON.stringify(produtos, null, 2);
       const blob = new Blob([json], {type:'application/json'});
       const url = URL.createObjectURL(blob);
       const a = document.createElement('a');
       a.href = url;
-      a.download = `almoxarifado_${new Date().toISOString().split('T')[0]}.json`;
+      a.download = `ALMOX2026_${new Date().toISOString().split('T')[0]}.json`;
       a.click();
       URL.revokeObjectURL(url);
       exibirToast('âœ… JSON exportado!');
     }
 
+    async function salvarArquivoJSON(manual = false){
+      const json = JSON.stringify(produtos, null, 2);
+
+      if (!window.showSaveFilePicker){
+        if (manual) exportarJSON();
+        return;
+      }
+
+      try{
+        if (!arquivoHandle){
+          arquivoHandle = await window.showSaveFilePicker({
+            suggestedName: 'ALMOX2026.json',
+            types: [{ description: 'Arquivo JSON', accept: { 'application/json': ['.json'] } }]
+          });
+        }
+
+        const writable = await arquivoHandle.createWritable();
+        await writable.write(json);
+        await writable.close();
+
+        if (manual) exibirToast('âœ… Dados salvos no arquivo!');
+      }catch(err){
+        if (manual) exibirToast('âš ï¸ Salvamento cancelado', 'aviso');
+      }
+    }
+
     function exportarCSV(){
       let csv = 'CÃ³digo1,CÃ³digo2,Nome,Setor,Estoque Atual,Estoque MÃ­nimo,PreÃ§o\\n';
       produtos.forEach(p => {
         csv += `"${String(p.codigo1 || '').replace(/"/g,'""')}","${String(p.codigo2 || '').replace(/"/g,'""')}","${String(p.nome || '').replace(/"/g,'""')}","${String(p.setor || '').replace(/"/g,'""')}",${p.estoqueAtual || 0},${p.estoqueMin || 0},${p.preco || 0}\\n`;
       });
       const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
       const url = URL.createObjectURL(blob);
       const a = document.createElement('a');
       a.href = url;
       a.download = `almoxarifado_${new Date().toISOString().split('T')[0]}.csv`;
       a.click();
       URL.revokeObjectURL(url);
       exibirToast('âœ… CSV exportado!');
     }
 
     function verificarDados(){
       const tamanho = new Blob([JSON.stringify(localStorage)]).size;
       document.getElementById('diagnostico').innerHTML = `
         <p>ğŸ“¦ <strong>Produtos:</strong> ${produtos.length}</p>
         <p>ğŸ“‚ <strong>Setores Ãºnicos:</strong> ${new Set(produtos.map(p => p.setor)).size}</p>
         <p>ğŸ’¾ <strong>Tamanho:</strong> ${(tamanho / 1024).toFixed(2)} KB</p>
         <p>ğŸ• <strong>Atualizado:</strong> ${new Date().toLocaleString('pt-BR')}</p>
         <p style="margin-top:12px;">âœ… Sistema OK!</p>
       `;
     }
 
EOF
)
